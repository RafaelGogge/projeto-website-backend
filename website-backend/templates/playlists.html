<!DOCTYPE html>
<html lang="pt-br">
<head>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <meta charset="UTF-8">
    <title>Playlists - Spotify CRUD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/playlists.css">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/static/js/playlists.js"></script>
</head>
<body>
    <header class="mb-4">
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark rounded shadow-sm py-3">
            <div class="container">
                <a class="navbar-brand d-flex align-items-center" href="/">
                    <span class="logo-icon me-2" style="font-size:1.7rem; color:#ff4b2b;">&#9835;</span>
                    <span class="fw-bold" style="font-size:1.4rem; letter-spacing:1px;">RhythmBox</span>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="/">Buscar</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if request.path.startswith('/favoritos') %}active{% endif %}" href="/favoritos">Favoritos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link {% if request.path.startswith('/playlists') %}active{% endif %}" href="/playlists">Playlists</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <main class="container">
        <button class="btn btn-outline-secondary mb-3" onclick="window.history.back(); return false;">
            &larr; Voltar
        </button>
        <h2 class="h5 mb-3">Minhas Playlists</h2>
        <form id="criarPlaylistForm" class="row g-3 mb-4">
            <div class="col-md-4">
                <input type="text" class="form-control" name="name" placeholder="Nome da playlist" required>
            </div>
            <div class="col-md-4">
                <input type="text" class="form-control" name="description" placeholder="Descrição (opcional)">
            </div>
            <div class="col-md-2 d-flex align-items-center">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="public" id="public">
                    <label class="form-check-label" for="public">Pública</label>
                </div>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">Criar Playlist</button>
            </div>
        </form>
        {% if playlists %}
            <div class="row">
            {% for playlist in playlists %}
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card playlist-card shadow-lg border-0 h-100">
                        {% if playlist.image_url %}
                        <div style="height: 50%; min-height: 140px; max-height: 180px; overflow: hidden;">
                            <img src="{{ playlist.image_url }}" alt="Capa" class="playlist-img" />
                        </div>
                        {% endif %}
                        <div class="card-body d-flex flex-column align-items-center text-center" style="height: 50%; min-height: 140px;">
                            <h5 class="card-title mb-1 fw-bold" style="color:#222; text-shadow:0 1px 0 #fff8dc;">{{ playlist.name }}</h5>
                            <span class="badge bg-warning text-dark mb-2" style="font-size:0.95em; font-weight:600;">{{ playlist.owner }}</span>
                            <h6 class="card-subtitle mb-2" style="color:#bfa13a; font-weight:600;">{{ playlist.total_tracks }} músicas</h6>
                            <p class="card-text mb-2" style="color:#444; min-height:2.2em;">{{ playlist.description }}</p>
                            {% if playlist.spotify_url %}
                                <button class="btn btn-success btn-sm px-4 py-2 mt-2 fw-bold shadow-sm" style="border-radius:2em; letter-spacing:0.5px;" onclick="confirmSpotifyRedirect('{{ playlist.spotify_url }}', '{{ playlist.name|e }}')">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" class="bi bi-spotify me-1" viewBox="0 0 16 16"><path d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zm3.69 11.69a.62.62 0 0 1-.85.19c-2.34-1.43-5.29-1.75-8.77-.95a.62.62 0 1 1-.27-1.22c3.8-.84 7.04-.48 9.67 1.08a.62.62 0 0 1 .22.9zm1.2-2.56a.78.78 0 0 1-1.07.24c-2.67-1.64-6.74-2.12-9.9-1.15a.78.78 0 1 1-.44-1.5c3.6-1.06 8.04-.54 11.1 1.32a.78.78 0 0 1 .31 1.09zm.13-2.63C10.73 4.7 5.27 4.57 2.73 5.32a.93.93 0 1 1-.52-1.8c2.89-.83 8.03-.68 11.1 1.45a.93.93 0 0 1-.97 1.6z"/></svg>
                                    Ouvir no Spotify
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
            </div>
        {% else %}
            <div class="alert alert-info">Nenhuma playlist encontrada.</div>
        {% endif %}
    </main>
    <!-- JS removido para arquivo externo -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
